.. pybpodapi documentation master file, created by
   sphinx-quickstart on Wed Jan 18 09:35:10 2017.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

.. _installing-label:

**********
How to use
**********

|

Obtain the 3D path of the dolphin
----------------------------------

1. Record 2 sychronized videos of a dolphin swimming in a pool.
2. Create an OBJ file representing the real world scenario with the `py3dscene-editor <https://bitbucket.org/UmSenhorQualquer/py3dsceneeditor>`_  application.
3. Execute the application d-track-singlecam for each of the cameras to extract the dolphin centroid.
4. Use the `pythonvideoannotator application <https://github.com/UmSenhorQualquer/pythonVideoAnnotator/>`_ to correct any error in the tracking.
5. Execute the application d-track-smoothpath to combine the cameras information and reconstruct the 3D path of the Dolphin. 

--------------------------------


D-Track
--------------------------------

|

d-track-singlecam
___________________________

This application is used to segment the images of each camera and find the dolphin in the pool.
Select the threshold values for each color channel. Try to color the dolphin as visible as possible.

.. image:: /_static/singlecam.png


====================    =================================================================================================================================
**FIELD**               **DESCRIPTION**
Scene file              OBJ file describing the pool. This file is generated by the py3dscene-editor application.
Video                   Video file captured with one of the cameras defined in the Scene file.
Frames range            Used to select range of the frames to analyse.
Camera                  Name given to the camera on the py3dscene-editor application.
Debug                   If active, a video with the results of the colors filtering will be generated.
Thresh block size       Parameter of the cv2.adaptiveThreshold for the blue component of each frame.
Thresh C value          Parameter of the cv2.adaptiveThreshold for the blue component of each frame.
Thresh block size       ...
Thresh C value          ...
Thresh block size       ...
Thresh C value          ...
====================    =================================================================================================================================


.. tip:: **Output data:** CSV file with the next format.
    
    ====================    ==============================================================================================
    **FIELD**               **DESCRIPTION**
    Column 1                Frame index.
    Column 2                X pixel coordenate of the blob centroid extracted from the frame after applying the filter 1.
    Column 3                Y pixel coordenate of the blob centroid extracted from the frame after applying the filter 1.
    Column 4                Area in pixels of the blob extracted from frame after applying the filter 1.
    Column 5                X pixel coordenate of the blob centroid extracted from the frame after applying the filter 2.
    Column 6                Y pixel coordenate of the blob centroid extracted from the frame after applying the filter 2.
    Column 7                Area in pixels of the blob extracted from frame after applying the filter 2.
    Column 8                X pixel coordenate of the blob centroid extracted from the frame after applying the filter 3.
    Column 9                Y pixel coordenate of the blob centroid extracted from the frame after applying the filter 3.
    Column 10               Area in pixels of the blob extracted from frame after applying the filter 3.
    ====================    ==============================================================================================


--------------------------------

|

d-track-smoothpath
___________________________

This application is used merge the output of the **d-track-smoothpath** application of the 2 cameras.

.. image:: /_static/smoothpath.png


========================    =================================================================================================================================
**FIELD**                   **DESCRIPTION**
Scene file                  OBJ file describing the pool. This file is generated by the py3dscene-editor application.
Tracking from camera 0      Camera 1 CSV output file from the d-track-singlecam.
Tracking from camera 1      Camera 2 CSV output file from the d-track-singlecam.
Output zip file             Name of the output zip file.
Refraction index            Refraction index to use to calculate the 3D position.
========================    =================================================================================================================================


.. tip:: **Output data:** CSV file with the next format.
    
    ====================    ==============================================================================================
    **FIELD**               **DESCRIPTION**
    Column 1                Frame index.
    Column 2                X 3d coordenate.
    Column 3                Y 3d coordenate.
    Column 4                Z 3d coordenate.
    Column 5                Used X pixel coordenate from camera 1.
    Column 6                Used Y pixel coordenate from camera 1.
    Column 7                The pixel from camera 1 is an estimation (False) or not (True).
    Column 8                Used X pixel coordenate from camera 2.
    Column 9                Used Y pixel coordenate from camera 2.
    Column 10               The pixel from camera 2 is an estimation (False) or not (True).
    ====================    ==============================================================================================



--------------------------------

|

d-track-render
___________________________

This application is used render the 3d positions found with the **d-track-smoothpath** application.

.. image:: /_static/d-track-render.png


========================    =================================================================================================================================
**FIELD**                   **DESCRIPTION**
Scene file                  OBJ file describing the pool. This file is generated by the py3dscene-editor application.
Video 0                     Camera 1 video file.
Video 1                     Camera 2 video file.
Data                        File containing the result from the d-track-smoothpath.
Output movie                (optional) Name of a video file where the rendering will be saved. The file should be from avi extension.
========================    =================================================================================================================================


.. tip:: **Output data:** Video from the 3d rendered scene.